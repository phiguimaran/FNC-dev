#!/bin/bash
set -e

echo ">> Backend: instalar dependencias y reiniciar servicio"
cd /home/adminuser/proyectos/fnc-dev/backend

source venv/bin/activate
pip install -r requirements.txt
deactivate

sudo systemctl restart fnc-backend.service
sudo systemctl status fnc-backend.service --no-pager

echo ">> Frontend: instalar dependencias y hacer build"
cd /home/adminuser/proyectos/fnc-dev/frontend

npm install
npm run build

echo ">> Nginx: probar configuraciÃ³n y recargar"
sudo nginx -t
sudo systemctl reload nginx
sudo systemctl status nginx --no-pager

echo ">> Listo: backend y frontend actualizados y levantados."

